parameters:
  paths:
    - ./app/Modules

  exclude_files:
    - '#.*Tests.*#'

  layers:
    # =================== Subscription Module ===================
    - name: SubscriptionPresentation
      collectors:
        - type: directory
          value: app/Modules/Subscription/Presentation

    - name: SubscriptionApplication
      collectors:
        - type: directory
          value: app/Modules/Subscription/Application

    - name: SubscriptionDomain
      collectors:
        - type: directory
          value: app/Modules/Subscription/Domain

    - name: SubscriptionInfrastructure
      collectors:
        - type: directory
          value: app/Modules/Subscription/Infrastructure

    # =================== Notification Module ===================
    - name: NotificationPresentation
      collectors:
        - type: directory
          value: app/Modules/Notification/Presentation

    - name: NotificationApplication
      collectors:
        - type: directory
          value: app/Modules/Notification/Application

    - name: NotificationDomain
      collectors:
        - type: directory
          value: app/Modules/Notification/Domain

    - name: NotificationInfrastructure
      collectors:
        - type: directory
          value: app/Modules/Notification/Infrastructure

    # =================== Email Module ===================
    - name: EmailPresentation
      collectors:
        - type: directory
          value: app/Modules/Email/Presentation

    - name: EmailApplication
      collectors:
        - type: directory
          value: app/Modules/Email/Application

    - name: EmailDomain
      collectors:
        - type: directory
          value: app/Modules/Email/Domain

    - name: EmailInfrastructure
      collectors:
        - type: directory
          value: app/Modules/Email/Infrastructure

    # =================== Weather Module ===================
    - name: WeatherPresentation
      collectors:
        - type: directory
          value: app/Modules/Weather/Presentation

    - name: WeatherApplication
      collectors:
        - type: directory
          value: app/Modules/Weather/Application

    - name: WeatherDomain
      collectors:
        - type: directory
          value: app/Modules/Weather/Domain

    - name: WeatherInfrastructure
      collectors:
        - type: directory
          value: app/Modules/Weather/Infrastructure

    # =================== Observability Module ===================
    - name: ObservabilityPresentation
      collectors:
        - type: directory
          value: app/Modules/Observability/Presentation

    - name: ObservabilityApplication
      collectors:
        - type: directory
          value: app/Modules/Observability/Application

    - name: ObservabilityDomain
      collectors:
        - type: directory
          value: app/Modules/Observability/Domain

    - name: ObservabilityInfrastructure
      collectors:
        - type: directory
          value: app/Modules/Observability/Infrastructure


  ruleset:
    # ----------------- Subscription -----------------
    SubscriptionPresentation:
      - SubscriptionApplication
      - SubscriptionDomain
    SubscriptionApplication:
      - SubscriptionDomain
      - WeatherPresentation # Cross-module allowed dependency
      - ObservabilityPresentation
    SubscriptionDomain: ~
    SubscriptionInfrastructure:
      - SubscriptionApplication
      - SubscriptionDomain
      - ObservabilityPresentation

    # ----------------- Notification -----------------
    NotificationPresentation:
      - NotificationApplication
      - NotificationDomain
    NotificationApplication:
      - NotificationDomain
      - WeatherPresentation # Cross-module allowed dependency
      - EmailPresentation # Cross-module allowed dependency
      - SubscriptionPresentation  # Cross-module allowed dependency
      - SubscriptionApplication  # Cross-module allowed dependency (events published)
      - ObservabilityPresentation
    NotificationDomain: ~
    NotificationInfrastructure:
      - NotificationApplication
      - NotificationDomain

    # ----------------- Email -----------------
    EmailPresentation:
      - EmailApplication
      - EmailDomain
    EmailApplication:
      - EmailDomain
    EmailDomain: ~
    EmailInfrastructure:
      - EmailApplication
      - EmailDomain
      - ObservabilityPresentation

    # ----------------- Weather -----------------
    WeatherPresentation:
      - WeatherApplication
      - WeatherDomain
    WeatherApplication:
      - WeatherDomain
    WeatherDomain: ~
    WeatherInfrastructure:
      - WeatherApplication
      - WeatherDomain
      - ObservabilityPresentation

    # ----------------- Observability -----------------
    ObservabilityPresentation:
      - ObservabilityApplication
      - ObservabilityDomain
    ObservabilityApplication:
      - ObservabilityDomain
    ObservabilityDomain: ~
    ObservabilityInfrastructure:
      - ObservabilityApplication
      - ObservabilityDomain
